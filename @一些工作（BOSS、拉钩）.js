// ==UserScript==
// @name         @一些工作（BOSS、拉钩）
// @namespace    http://tampermonkey.net/
// @version      2025.05.19
// @description  自动投递BOSS直聘和拉勾网职位。自带一个记录页面，可以记录相关数据。Ctrl + s 为保存，ecs 为退出，不支持自动保存，每次操作都要手动保存防止数据丢失。在职位列表页面拖动位置为日志面板，其他拖动位置为边框。
// @author       Y77H
// @match        https://www.zhipin.com/*
// @match        https://www.lagou.com/*
// @grant        GM_getValue
// @grant        GM_setValue
// @grant        GM_openInTab
// ==/UserScript==

(function () {
  'use strict';
  const SITE_TYPE={BOSS:"BOSS",LAGOU:"拉钩"},getCurrentSite=()=>{const t=window.location.href;return t.includes("zhipin.com")?SITE_TYPE.BOSS:t.includes("lagou.com")?SITE_TYPE.LAGOU:SITE_TYPE.BOSS},isJobsListingPage=()=>{const t=window.location.href;return!!t.includes("zhipin.com/web/geek/jobs")||!!t.includes("lagou.com/wn/jobs")},baseConfig={panelPosition:{[SITE_TYPE.BOSS]:{full:null,simple:null},[SITE_TYPE.LAGOU]:{full:null,simple:null}},keywords:GM_getValue("keywords","java mes"),excludeKeywords:GM_getValue("excludeKeywords","测试 前端 golang 支持 实施 运维 销售"),currentSite:getCurrentSite(),panelWidth:250},boss_Config={clickInterval:1500,scrollCheckInterval:800,scrollStep:1e4},laGou_Config={searchInterval:1e3,confirmDelay:800,knowDelay:800,clickDelay:1e3},utils={sleep:t=>new Promise((e=>setTimeout(e,t))),scrollToElement:(t,e=300)=>{if(!t)return;const o=t.getBoundingClientRect().top+window.scrollY-e;window.scrollTo({top:o,behavior:"smooth"})},getJobInfo:t=>{const e={title:"未知职位",company:"未知公司",location:"未知地区"};return baseConfig.currentSite===SITE_TYPE.BOSS?(e.title=t.querySelector(".job-name")?.textContent?.trim()||e.title,e.company=t.querySelector(".boss-info")?.textContent?.trim()||e.company,e.location=t.querySelector(".company-location")?.textContent?.trim()||e.location):(e.title=t.querySelector("#openWinPostion")?.textContent?.trim()||e.title,e.company=t.querySelector(".company-name__2-SjF")?.textContent?.trim()||e.company),e},updateButtonState:(t,e,o="",n=!1)=>{t&&(e?(n?(t.textContent="停止中...",t.style.background="rgba(244, 164, 96, 0.8)",t.style.boxShadow="0 2px 8px rgba(244, 164, 96, 0.2)"):(t.textContent=o?`处理进度：${o}`:"处理中...",t.style.background="rgba(231, 76, 60, 0.8)",t.style.boxShadow="0 2px 8px rgba(231, 76, 60, 0.2)"),t.onmouseover=null,t.onmouseout=null):(t.textContent="开始处理",t.style.background="rgba(67, 97, 238, 0.6)",t.style.boxShadow="0 2px 8px rgba(67, 97, 238, 0.2)",t.onmouseover=()=>{t.style.transform="translateY(-1px)",t.style.background="rgba(67, 97, 238, 0.8)",t.style.boxShadow="0 4px 12px rgba(67, 97, 238, 0.3)"},t.onmouseout=()=>{t.style.transform="translateY(0)",t.style.background="rgba(67, 97, 238, 0.6)",t.style.boxShadow="0 2px 8px rgba(67, 97, 238, 0.2)"}))},createNotification:(t,e="info")=>({message:t,colors:{info:{text:"#3498db",bg:"rgba(52, 152, 219, 0.1)",icon:"bi-info-circle-fill",bgSolid:"rgba(52, 152, 219, .95)",border:"rgb(41, 128, 185)"},success:{text:"#27ae60",bg:"rgba(39, 174, 96, 0.1)",icon:"bi-check-circle-fill",bgSolid:"rgba(46, 204, 113, .95)",border:"rgb(39, 174, 96)"},error:{text:"#e74c3c",bg:"rgba(231, 76, 60, 0.1)",icon:"bi-x-circle-fill",bgSolid:"rgba(231, 76, 60, .95)",border:"rgb(192, 57, 43)"},warning:{text:"#f39c12",bg:"rgba(243, 156, 18, 0.1)",icon:"bi-exclamation-circle-fill",bgSolid:"rgba(243, 156, 18, .95)",border:"rgb(230, 126, 34)"},primary:{text:"#4361ee",bg:"rgba(67, 97, 238, 0.1)",icon:"bi-clipboard-check-fill",bgSolid:"rgba(67, 97, 238, .95)",border:"rgb(48, 81, 211)"}}[e],type:e}),debounce:(t,e=300)=>{let o;return function(...n){const r=this;clearTimeout(o),o=setTimeout((()=>t.apply(r,n)),e)}},recentNotifications:{items:new Map,add:function(t,e){const o=`${t}_${e}`,n=Date.now(),r=this.items.get(o);return!!(r&&n-r<1500)||(this.items.set(o,n),this.cleanup(),!1)},cleanup:function(){const t=Date.now();for(const[e,o]of this.items.entries())t-o>1e4&&this.items.delete(e)}}};class JobProcessor{constructor(t){this.config=t,this.isRunning=!1,this.isProcessing=!1,this.processedJobs=[],this.currentPage=1,this.totalPages=1,this.currentJobIndex=0,this.isStopping=!1}async start(t){this.isRunning=!0,this.isStopping=!1,this.processedJobs=[],this.currentPage=1,this.currentJobIndex=0,utils.updateButtonState(t,!0),await this.processJobs(t)}requestStop(t){this.isProcessing?(this.isStopping=!0,utils.updateButtonState(t,!0,"",!0),updateStatus("正在完成当前职位处理后停止...","warning")):this.stop(t)}stop(t){this.isRunning=!1,this.isProcessing=!1,this.isStopping=!1,utils.updateButtonState(t,!1),updateStatus("已停止处理","warning")}stopWithReason(t,e="warning"){this.isRunning=!1,this.isProcessing=!1,this.isStopping=!1;const o=document.querySelector(".control-btn");o&&utils.updateButtonState(o,!1),updateStatus(t,e)}async findFilteredJobs(){return[]}async processJob(t){return!1}async processJobs(t){if(this.isRunning&&(!this.isProcessing||this.isStopping)){this.isProcessing=!0;try{if(this.isStopping)return void this.stop(t);const e=await this.findFilteredJobs();if(!e||0===e.length)return updateStatus("无符合条件的职位","warning"),void this.stop(t);if(this.currentJobIndex>=e.length)return baseConfig.currentSite===SITE_TYPE.BOSS?(updateStatus("所有职位处理完毕","success"),void this.stop(t)):this.hasNextPage&&await this.goToNextPage()?(this.isProcessing=!1,void setTimeout((()=>this.processJobs(t)),this.config.searchInterval||1e3)):(updateStatus("处理完成","success"),void this.stop(t));const o=e[this.currentJobIndex];if(utils.updateButtonState(t,!0,`${this.currentJobIndex+1}/${e.length}`,this.isStopping),await this.processJob(o)){const t=utils.getJobInfo(o);this.processedJobs.push({...t,time:(new Date).toLocaleTimeString()})}if(this.currentJobIndex++,this.isProcessing=!1,this.isStopping)return void this.stop(t);const n=this.config.searchInterval||this.config.clickInterval||1e3;setTimeout((()=>this.processJobs(t)),n)}catch(e){this.isProcessing=!1,updateStatus("处理出错","error"),this.stop(t)}}}}class BossProcessor extends JobProcessor{constructor(){super(boss_Config),this.hasNextPage=!1,this.retryCount=0}async scrollToBottom(){return new Promise((t=>{let e=document.documentElement.scrollHeight,o=0;updateStatus("加载更多职位中...","info");const n=setInterval((()=>{if(!this.isRunning)return clearInterval(n),void t();window.scrollBy(0,this.config.scrollStep),setTimeout((()=>{const r=document.documentElement.scrollHeight;r===e?(o++,o>=3&&(clearInterval(n),t())):(o=0,e=r)}),500)}),this.config.scrollCheckInterval)}))}async findFilteredJobs(){let t=Array.from(document.querySelectorAll("li.job-card-box")).filter(checkJobKeywords);if(this.currentJobIndex>=t.length&&this.retryCount<3&&this.isRunning){if(this.retryCount++,updateStatus(`尝试加载更多职位 (${this.retryCount}/3)...`,"info"),await this.scrollToBottom(),!this.isRunning)return[];if(t=Array.from(document.querySelectorAll("li.job-card-box")).filter(checkJobKeywords),this.currentJobIndex>=t.length)return updateStatus("没有更多职位可处理","info"),[];updateStatus(`发现${t.length-this.currentJobIndex}个新职位`,"success")}return t}findChatButton(){let t=document.querySelector(".op-btn.op-btn-chat");return null!=t&&"立即沟通"==t.textContent?t:null}findStayButton(){return document.querySelector(".default-btn.cancel-btn")}checkChatLimit(){const t=document.querySelector(".chat-block-container");return t&&t.textContent.includes("今日沟通人数已达上限，请明天再试")}async processJob(t){if(!t)return!1;const e=utils.getJobInfo(t),o=`${e.title} | ${e.company}`;utils.scrollToElement(t),await utils.sleep(1e3),t.click(),await utils.sleep(this.config.clickInterval);const n=this.findChatButton();if(n){if(n.click(),await utils.sleep(this.config.clickInterval),this.checkChatLimit())return updateStatus(`${o} | 达到沟通上限`,"warning"),setTimeout((()=>this.stopWithReason("已达到沟通上限，处理已停止","warning")),0),!1;const t=this.findStayButton();return t&&t.click(),updateStatus(`${o} | 沟通成功`,"success"),!0}return updateStatus(`${o} | 不可沟通`,"error"),!1}stop(t){this.retryCount=0,super.stop(t)}stopWithReason(t,e="warning"){this.retryCount=0,super.stopWithReason(t,e)}}class LaGouProcessor extends JobProcessor{constructor(){super(laGou_Config)}updatePageInfo(){const t=document.querySelectorAll(".lg-pagination-item");if(t.length>0){const e=Array.from(t).filter((t=>!isNaN(parseInt(t.textContent.trim())))).pop();e&&(this.totalPages=parseInt(e.textContent.trim()));const o=document.querySelector(".lg-pagination-item-active");o&&(this.currentPage=parseInt(o.textContent.trim()))}this.hasNextPage=this.currentPage<this.totalPages}waitForPageLoad(){return new Promise((t=>{const e=()=>{document.querySelectorAll(".item__10RTO").length>0?setTimeout(t,500):setTimeout(e,100)};setTimeout(e,this.config.pageLoadDelay||500)}))}async findFilteredJobs(){return this.updatePageInfo(),Array.from(document.querySelectorAll(".item__10RTO")).filter(checkJobKeywords)}async goToNextPage(){if(this.currentPage<this.totalPages){const t=document.querySelector(".lg-pagination-next");if(t&&!t.classList.contains("lg-pagination-disabled"))return this.currentPage++,this.currentJobIndex=0,t.click(),await this.waitForPageLoad(),!0}return!1}async processJob(t){if(!t)return!1;const e=utils.getJobInfo(t),o=`${e.title} | ${e.company}`;utils.scrollToElement(t),await utils.sleep(500);const n=t.querySelector(".p-top__1F7CL");if(n)try{const t=new Event("mouseover",{bubbles:!0,cancelable:!0});n.dispatchEvent(t)}catch(t){}await utils.sleep(this.config.clickDelay);const r=document.querySelector(".rc-trigger-popup.index-module_job_details__2LK3w:not(.rc-trigger-popup-hidden) button");if(r&&"投简历"===r.textContent){r.click(),await utils.sleep(this.config.confirmDelay);const t=document.querySelector(".lg-design-modal-root .lg-design-modal-mask")?.nextSibling?.querySelector(".lg-design-btn.lg-design-btn-primary");if(t&&"确认投递"===t.textContent){t.click(),await utils.sleep(this.config.knowDelay);const e=document.querySelector(".lg-design-modal-root .lg-design-modal-mask")?.nextSibling?.querySelector(".lg-design-btn.lg-design-btn-primary");if(e&&"我知道了"===e.textContent)return e.click(),this.config.appliedCount++,updateStatus(`${o} | 投递成功`,"success"),!0}}else if(r)return r.click(),updateStatus(`${o} | 不可投递`,"error"),!1}async start(t){super.start(t),this.config.appliedCount=0}}function loadSavedPosition(){const t={top:"200px",left:window.innerWidth-300+"px"},e=isJobsListingPage(),o=e?"full":"simple",n=baseConfig.currentSite===SITE_TYPE.BOSS?e?"bossPosition":"bossSimplePosition":e?"lagouPosition":"lagouSimplePosition";try{const e=GM_getValue(n,t);baseConfig.currentSite===SITE_TYPE.BOSS?baseConfig.panelPosition[SITE_TYPE.BOSS][o]=e:baseConfig.panelPosition[SITE_TYPE.LAGOU][o]=e;const r=baseConfig.panelPosition[baseConfig.currentSite][o];r&&r.top&&r.left&&(r.top.includes("px")||r.top.includes("%"))&&(r.left.includes("px")||r.left.includes("%"))||(baseConfig.panelPosition[baseConfig.currentSite][o]=t)}catch(e){baseConfig.panelPosition[baseConfig.currentSite][o]=t}}function savePanelPosition(t){try{const e=t.getBoundingClientRect(),o=isJobsListingPage(),n=o?"full":"simple",r={top:`${e.top}px`,left:`${e.left}px`};baseConfig.panelPosition[baseConfig.currentSite][n]=r;const i=baseConfig.currentSite===SITE_TYPE.BOSS?o?"bossPosition":"bossSimplePosition":o?"lagouPosition":"lagouSimplePosition";GM_setValue(i,r)}catch(t){}}function showJobsRecordModal(){const t=document.getElementById("jobs-record-modal");t&&document.body.removeChild(t);const e=document.createElement("div");e.id="jobs-record-modal",e.style.cssText="\n      position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);z-index:9999999;display:flex;align-items:center;justify-content:center;font-family:'PingFang SC','Microsoft YaHei','Segoe UI',Tahoma,Geneva,Verdana,sans-serif;\n    ";const o=document.createElement("style");o.textContent="\n      :root{--border-color:#dee2e6;--primary-color:#4361ee;--success-color:#2ecc71;--info-color:#3498db;--danger-color:#e74c3c;--warning-color:#f39c12;--light-bg:#f8f9fa;--plan-color:#4caf50;--text-color:#2c3e50;--text-secondary:#6c757d;--shadow-sm:0 2px 4px rgba(0,0,0,.05);--shadow-md:0 4px 6px rgba(0,0,0,.1);--shadow-lg:0 10px 15px rgba(0,0,0,.1)}#jobs-record-modal .main-container{overflow:hidden;display:flex;flex-direction:column;width:98%;max-width:2000px;height:98vh;max-height:98vh;margin:0;padding:0;background-color:#f5f7fa;border-radius:10px;box-shadow:0 10px 25px rgba(0,0,0,0.2)}#jobs-record-modal .container{overflow-y:hidden;display:flex;flex:1;flex-direction:column;height:100%;max-height:100%;padding:20px 20px 15px 20px;background:#fff;border-radius:10px;box-sizing:border-box;width:100%}#jobs-record-modal .content-wrapper{overflow:hidden;display:flex;flex:1;height:calc(100% - 20px);gap:20px;width:100%}#jobs-record-modal .left-panel{overflow:hidden;display:flex;flex:1;flex-direction:column;width:100%}#jobs-record-modal .right-panel{overflow:hidden;display:flex;flex-direction:column;width:380px;min-width:380px;padding-right:0}#jobs-record-modal .section{margin-bottom:20px;padding:0;border-bottom:0}#jobs-record-modal .section:last-child{overflow:hidden;display:flex;flex:1;flex-direction:column;margin-bottom:0;padding-bottom:0}#jobs-record-modal .plan-section{margin-bottom:20px}#jobs-record-modal .common-info-container{margin-bottom:0;padding:0}#jobs-record-modal .company-section{overflow:hidden;display:flex;flex:1;flex-direction:column;padding-bottom:0}#jobs-record-modal .table-responsive{overflow:hidden;overflow-x:hidden;display:flex;flex:1;flex-direction:column;height:1px;margin:0 0 10px 0;padding:0;border:1px solid var(--border-color);border-radius:8px;box-sizing:border-box}#jobs-record-modal .summary-content-wrapper{overflow:hidden;display:flex;flex:1;flex-direction:column;padding:5px;border:0;background:#fff;border-radius:0;box-shadow:none}#jobs-record-modal .summary-title{display:flex;align-items:center;flex-shrink:0;position:relative;margin:0 0 15px 0;padding-left:15px;border-bottom:0;background-color:transparent;color:var(--text-color);font-size:20px;font-weight:600;border-radius:0}#jobs-record-modal .summary-title:before{content:'';position:absolute;top:50%;left:0;width:4px;height:20px;margin-right:0;background-color:var(--primary-color);transform:translateY(-50%);border-radius:2px}#jobs-record-modal .summary-textarea{overflow-y:auto;flex:1;width:100%;height:100%;min-height:60px;margin:0;padding:15px;border:1px solid #ddd;background-color:#f5f7fd;color:var(--text-color);font-family:inherit;font-size:14px;line-height:1.5;white-space:pre-wrap;word-wrap:break-word;outline:0;resize:none;transition:all .3s ease;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,.05);box-sizing:border-box}#jobs-record-modal .common-info-textarea{overflow-y:hidden;width:100%;height:auto;min-height:60px;padding:15px;border:1px solid #ddd;background-color:#f9fff9;font-family:inherit;font-size:14px;line-height:1.6;outline:0;resize:none;transition:all .3s ease;border-radius:8px;box-shadow:0 1px 3px rgba(0,0,0,.05);box-sizing:border-box}#jobs-record-modal h2{display:flex;align-items:center;position:relative;margin-top:0;margin-bottom:20px;padding-left:15px;color:var(--text-color);font-size:20px;font-weight:600}#jobs-record-modal h2:before{content:'';position:absolute;top:50%;left:0;width:4px;height:20px;background-color:var(--info-color);transform:translateY(-50%);border-radius:2px}#jobs-record-modal .section.plan-section h2:before{background-color:var(--plan-color)}#jobs-record-modal .section.company-section h2:before{background-color:var(--info-color)}#jobs-record-modal .table-header{position:sticky;z-index:10;top:0;width:100%;background-color:var(--primary-color)}#jobs-record-modal .table-body{overflow-x:hidden;overflow-y:auto;flex:1;width:100%}#jobs-record-modal table{width:100%;margin:0;padding:0;border:0;font-size:14px;border-collapse:separate;border-spacing:0;table-layout:fixed;border-radius:0;box-shadow:none}#jobs-record-modal th{position:sticky;z-index:10;top:0;padding:12px 8px;background-color:var(--primary-color);color:white;font-size:14px;font-weight:500;text-align:center;letter-spacing:.5px}#jobs-record-modal tr:hover{background-color:rgba(67,97,238,.04)}#jobs-record-modal tr:nth-child(odd){background-color:#fff}#jobs-record-modal tr:nth-child(even){background-color:rgba(240,242,245,.6)}#jobs-record-modal tr:last-child td{border-bottom:0}#jobs-record-modal input[type='text'],#jobs-record-modal select{width:100%;margin:2px 0;padding:6px 8px;border:1px solid #ddd;font-size:14px;transition:all .3s ease;border-radius:4px;box-sizing:border-box}#jobs-record-modal input[type='text']:focus,#jobs-record-modal select:focus{border-color:var(--primary-color);outline:0;box-shadow:0 0 0 2px rgba(67,97,238,.1)}\n#jobs-record-modal input[type='checkbox']{display:block;position:relative;top:2px;width:20px;height:20px;margin:0 auto;cursor:pointer;accent-color:var(--primary-color)}#jobs-record-modal td{padding:8px}#jobs-record-modal td>*{margin:2px 0}#jobs-record-modal .table-btn{display:flex!important;align-items:center!important;justify-content:center!important;width:24px!important;height:24px!important;margin:0 1px!important;padding:0!important;border:none!important;background:none!important;font-size:18px!important;cursor:pointer!important;transition:all .2s ease!important;border-radius:50%!important}#jobs-record-modal .table-btn:hover{background-color:rgba(0,0,0,.05)!important;transform:scale(1.1)!important}#jobs-record-modal .table-btn.delete{color:var(--danger-color)!important}#jobs-record-modal .table-btn.confirm{color:var(--success-color)!important}#jobs-record-modal .move-btn{display:flex!important;align-items:center!important;justify-content:center!important;width:24px!important;height:24px!important;margin:0 1px!important;padding:0!important;border:none!important;background:none!important;font-size:18px!important;cursor:pointer!important;transition:all .2s ease!important;border-radius:50%!important}#jobs-record-modal .move-btn:hover{background-color:rgba(0,0,0,.05)!important;transform:scale(1.1)!important}#jobs-record-modal .move-btn.up{color:var(--success-color)!important}#jobs-record-modal .move-btn.down{color:var(--warning-color)!important}#jobs-record-modal .move-btn.disabled{color:#ccc!important;cursor:not-allowed!important}#jobs-record-modal .move-btn.disabled:hover{background:none!important;transform:none!important}#jobs-record-modal .remark-btn{display:inline-flex!important;align-items:center!important;justify-content:center!important;position:relative!important;width:28px!important;height:28px!important;margin:0 auto!important;padding:0!important;border:1px solid var(--border-color)!important;background-color:#fff!important;color:var(--primary-color)!important;font-size:14px!important;text-align:center!important;cursor:pointer!important;transition:all .3s ease!important;border-radius:4px!important;box-shadow:var(--shadow-sm)!important}#jobs-record-modal .remark-btn.has-content{border-color:var(--primary-color)!important;background-color:var(--primary-color)!important;color:white!important}#jobs-record-modal .remark-btn:hover{transform:translateY(-1px)!important;box-shadow:0 3px 8px rgba(0,0,0,0.1)!important}#jobs-record-modal .add-btn{display:flex!important;align-items:center!important;justify-content:center!important;width:100%!important;height:36px!important;margin-top:5px!important;margin-bottom:0!important;border:none!important;background-color:var(--primary-color)!important;color:white!important;font-size:15px!important;font-weight:bold!important;cursor:pointer!important;transition:all .3s ease!important;border-radius:8px!important;box-shadow:0 4px 10px rgba(67,97,238,.3)!important}#jobs-record-modal .add-btn:hover{background-color:rgba(67,97,238,.9)!important;transform:translateY(-2px)!important;box-shadow:0 6px 12px rgba(67,97,238,.4)!important}#jobs-record-modal .floating-buttons{display:flex!important;flex-direction:column!important;position:fixed!important;z-index:10000!important;right:25px!important;bottom:25px!important;gap:12px!important}#jobs-record-modal .floating-btn{display:flex!important;align-items:center!important;justify-content:center!important;width:50px!important;height:50px!important;border:none!important;color:white!important;font-size:20px!important;cursor:pointer!important;transition:all .3s cubic-bezier(.4,0,.2,1)!important;border-radius:50%!important;box-shadow:0 4px 12px rgba(0,0,0,.15)!important;backdrop-filter:blur(8px)!important;-webkit-backdrop-filter:blur(8px)!important}#jobs-record-modal .floating-btn:hover{transform:translateY(-3px)!important;box-shadow:0 6px 16px rgba(0,0,0,.2)!important}#jobs-record-modal .floating-btn.save{background-color:var(--success-color)!important}#jobs-record-modal .floating-btn.restore{background-color:var(--primary-color)!important}#jobs-record-modal .floating-btn.export{background-color:var(--info-color)!important}#jobs-record-modal .floating-btn.close{background-color:var(--danger-color)!important}#jobs-record-modal table#companyTable th:nth-child(1),#jobs-record-modal table#companyTable td:nth-child(1),#jobs-record-modal table#companyTableHeader th:nth-child(1){width:80px}#jobs-record-modal table#companyTable th:nth-child(2),#jobs-record-modal table#companyTable td:nth-child(2),#jobs-record-modal table#companyTableHeader th:nth-child(2){width:18%}#jobs-record-modal table#companyTable th:nth-child(3),#jobs-record-modal table#companyTable td:nth-child(3),#jobs-record-modal table#companyTableHeader th:nth-child(3){width:40%;text-align:center}#jobs-record-modal table#companyTable th:nth-child(4),#jobs-record-modal table#companyTable td:nth-child(4),#jobs-record-modal table#companyTableHeader th:nth-child(4){width:10%;text-align:center}\n#jobs-record-modal table#companyTable th:nth-child(5),#jobs-record-modal table#companyTable td:nth-child(5),#jobs-record-modal table#companyTableHeader th:nth-child(5){width:10%;text-align:center}#jobs-record-modal table#companyTable th:nth-child(6),#jobs-record-modal table#companyTable td:nth-child(6),#jobs-record-modal table#companyTableHeader th:nth-child(6){width:60px;text-align:center}#jobs-record-modal table#companyTable th:nth-child(7),#jobs-record-modal table#companyTable td:nth-child(7),#jobs-record-modal table#companyTableHeader th:nth-child(7){width:60px;vertical-align:middle;text-align:center}#jobs-record-modal .action-cell{text-align:center}#jobs-record-modal td.action-cell{vertical-align:middle;text-align:center}#jobs-record-modal .remark-modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,0.5);z-index:10000;align-items:center;justify-content:center}#jobs-record-modal .remark-modal-content{position:relative;width:500px;max-width:90%;background-color:white;border-radius:10px;padding:25px;box-shadow:0 10px 25px rgba(0,0,0,0.2)}#jobs-record-modal .remark-modal-content h3{margin-top:0;margin-bottom:15px;color:var(--primary-color);font-size:20px;font-weight:600}#jobs-record-modal #remarkTextarea{width:100%;height:200px;padding:12px;border:1px solid #ddd;border-radius:6px;font-family:inherit;font-size:14px;line-height:1.5;resize:none;margin-bottom:15px}#jobs-record-modal #remarkTextarea:focus{border-color:var(--primary-color);outline:0;box-shadow:0 0 0 3px rgba(67,97,238,.1)}#jobs-record-modal .remark-modal-buttons{display:flex;justify-content:flex-end;gap:10px}#jobs-record-modal .cancel-btn,#jobs-record-modal .save-btn{padding:8px 16px;border:0;border-radius:5px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s ease}#jobs-record-modal .cancel-btn{background-color:#f8f9fa;color:#666;border:1px solid #ddd}#jobs-record-modal .cancel-btn:hover{background-color:#e9ecef}#jobs-record-modal .save-btn{background-color:var(--primary-color);color:white}#jobs-record-modal .save-btn:hover{background-color:rgba(67,97,238,.9)}#jobs-record-modal .close-btn{position:absolute;top:10px;right:10px;width:30px;height:30px;background:0;border:0;font-size:24px;line-height:1;color:#999;cursor:pointer;transition:color .2s ease}#jobs-record-modal .close-btn:hover{color:#333}@keyframes highlight{0%{background-color:rgba(231,76,60,.1)}50%{background-color:rgba(231,76,60,.2)}100%{background-color:rgba(231,76,60,.1)}}#jobs-record-modal .delete-confirm{animation:highlight 1s ease-in-out infinite}#jobs-record-modal .bi{display:inline-block!important;line-height:1!important;vertical-align:-.125em!important;fill:currentColor!important}\n    ",document.head.appendChild(o);const n=document.createElement("div");n.className="main-container",n.innerHTML='\n      <div class="container"><div id="notificationsContainer" class="notifications-container" style="position: absolute; top: 70px; right: 25px; z-index: 10000; display: flex; flex-direction: column; gap: 10px; max-width: 330px;"></div><div class="content-wrapper"><div class="left-panel"><div class="section plan-section"><h2>常用信息</h2><div class="common-info-container"><textarea id="commonInfo" class="common-info-textarea" placeholder="在这里输入常用信息..."></textarea></div></div><div class="section company-section"><h2>公司信息</h2><div class="table-responsive"><div class="table-header"><table id="companyTableHeader"><thead><tr><th>操作</th><th>名称</th><th>信息</th><th>职位</th><th>薪资</th><th>记录</th><th>外包</th></tr></thead></table></div><div class="table-body"><table id="companyTable"><tbody></tbody></table></div></div><button class="add-btn" id="addCompanyBtn"><i class="bi bi-plus-lg"></i></button></div></div><div class="right-panel"><div class="summary-content-wrapper"><h2 class="summary-title">记录汇总</h2><textarea id="summaryTextarea" class="summary-textarea" readonly placeholder="暂无记录"></textarea></div></div></div><div class="floating-buttons"><button class="floating-btn save" id="saveDataBtn" title="保存信息"><i class="bi bi-save"></i></button><button class="floating-btn restore" id="restoreDataBtn" title="恢复信息"><i class="bi bi-arrow-clockwise"></i></button><button class="floating-btn export" id="exportDataBtn" title="导出为Markdown"><i class="bi bi-clipboard"></i></button><button class="floating-btn close" id="closeJobsModal" title="关闭窗口" style="background-color: #e74c3c;"><i class="bi bi-x"></i></button></div></div>\n    ';const r=document.createElement("div");if(r.id="remarkModal",r.className="remark-modal",r.innerHTML='\n      <div class="remark-modal-content"><button class="close-btn" id="closeRemarkModalBtn">&times;</button><h3>记录</h3><textarea id="remarkTextarea" placeholder="请记录..."></textarea><div class="remark-modal-buttons"><button class="cancel-btn" id="cancelRemarkBtn">取消</button><button class="save-btn" id="saveRemarkBtn">保存</button></div></div>\n    ',e.appendChild(n),e.appendChild(r),document.body.appendChild(e),!document.querySelector('link[href*="bootstrap-icons"]')){const t=document.createElement("link");t.rel="stylesheet",t.href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css",document.head.appendChild(t),setTimeout((()=>{if(!document.querySelector(".bi")){const t=document.createElement("style");t.textContent='\n            .bi-plus-lg:before{content:"+";font-weight:bold;font-size:18px}.bi-trash:before{content:"🗑️"}.bi-check-lg:before{content:"✓";font-weight:bold}.bi-arrow-up:before{content:"↑"}.bi-arrow-down:before{content:"↓"}.bi-pencil-square:before{content:"✎"}.bi-save:before{content:"💾"}.bi-arrow-clockwise:before{content:"↻"}.bi-clipboard:before{content:"📋"}.bi-info-circle-fill:before{content:"ℹ"}.bi-check-circle-fill:before{content:"✓"}.bi-exclamation-circle-fill:before{content:"⚠"}.bi-x-circle-fill:before{content:"✕"}.bi-clipboard-check-fill:before{content:"✓"}.bi-x:before{content:"×"}\n          ',document.head.appendChild(t)}}),1e3)}let i=JSON.parse(GM_getValue("jobsRecordCompanyData","[]")),a=GM_getValue("jobsRecordCommonInfoData",""),s=-1,l=0;function c(t,e="info"){const o=document.getElementById("notificationsContainer");if(!o)return;const n="notification-"+l++,r=document.createElement("div");if(r.id=n,r.className=`notification ${e}`,r.style.cssText="\n        display:flex;align-items:center;width:100%;min-width:260px;max-width:320px;padding:12px 15px;margin-bottom:8px;font-size:14px;font-weight:500;opacity:0;transition:all .3s cubic-bezier(.4,0,.2,1);transform:translateX(30px);animation:slide-in .3s forwards,slide-out .3s forwards 2.8s;border-radius:8px;box-shadow:0 6px 16px rgba(0,0,0,.2);gap:10px;backdrop-filter:blur(6px);-webkit-backdrop-filter:blur(6px);\n      ",!document.getElementById("notification-animations")){const t=document.createElement("style");t.id="notification-animations",t.textContent="\n          @keyframes slide-in{0%{opacity:0;transform:translateX(30px)}100%{opacity:1;transform:translateX(0)}}@keyframes slide-out{0%{opacity:1;transform:translateX(0)}100%{opacity:0;transform:translateX(30px)}}\n        ",document.head.appendChild(t)}const i=utils.createNotification(t,e).colors,a=i.icon,s=i.bgSolid,c=i.border;r.style.backgroundColor=s,r.style.borderLeft=`3px solid ${c}`,r.style.color="white",r.innerHTML=`\n        <i class="bi ${a}" style="flex-shrink: 0; font-size: 18px;"></i><span style="flex-grow: 1; line-height: 1.4;">${t}</span><button onclick="document.getElementById('${n}').remove()" style="          display: flex;          align-items: center;          justify-content: center;          width: 22px;          height: 22px;          padding: 0;          border: none;          background: rgba(255, 255, 255, 0.15);          color: white;          font-size: 14px;          opacity: .8;          cursor: pointer;          transition: all .2s ease;          border-radius: 50%;        "><i class="bi bi-x"></i></button>\n      `,o.appendChild(r),setTimeout((()=>{document.getElementById(n)&&r.remove()}),3e3)}function d(){const t=document.querySelector("#jobs-record-modal #companyTable tbody");if(t){if(t.innerHTML="",0===i.length){const e=document.createElement("tr"),o=document.createElement("td");return o.colSpan=7,o.textContent="暂无公司信息，点击下方按钮添加",o.style.textAlign="center",o.style.padding="20px",o.style.color="#888",e.appendChild(o),void t.appendChild(e)}i.forEach(((e,o)=>{const n=document.createElement("tr"),r=document.createElement("td");r.className="action-cell";const a=document.createElement("div");a.style.display="flex",a.style.justifyContent="center",a.style.gap="4px";const l=document.createElement("button");l.innerHTML='<i class="bi bi-arrow-up"></i>',l.className="move-btn up "+(0===o?"disabled":""),l.title="上移",l.onclick=()=>{o>0&&b(o,-1)};const p=document.createElement("button");p.innerHTML='<i class="bi bi-arrow-down"></i>',p.className="move-btn down "+(o===i.length-1?"disabled":""),p.title="下移",p.onclick=()=>{o<i.length-1&&b(o,1)};const h=document.createElement("button");h.innerHTML='<i class="bi bi-trash"></i>',h.className="table-btn delete",h.title="删除",h.onclick=function t(){this.innerHTML='<i class="bi bi-check-lg"></i>',this.className="table-btn confirm",this.title="确认删除",n.classList.add("delete-confirm"),setTimeout((()=>{n.classList.contains("delete-confirm")&&(this.innerHTML='<i class="bi bi-trash"></i>',this.className="table-btn delete",this.title="删除",n.classList.remove("delete-confirm"),this.onclick=t)}),3e3),this.onclick=function(){"table-btn confirm"===this.className&&(n.classList.remove("delete-confirm"),function(t){i.splice(t,1),d(),m(),c("公司信息已删除","error")}(o))}},a.appendChild(l),a.appendChild(p),a.appendChild(h),r.appendChild(a),n.appendChild(r);const g=document.createElement("td");g.style.textAlign="center";const f=document.createElement("input");f.type="text",f.value=e.name||"",f.placeholder="公司名称",f.oninput=()=>u(o,"name",f.value),g.appendChild(f),n.appendChild(g);const x=document.createElement("td");x.style.textAlign="center";const y=document.createElement("input");y.type="text",y.value=e.size||"",y.placeholder="公司信息",y.oninput=()=>u(o,"size",y.value),x.appendChild(y),n.appendChild(x);const v=document.createElement("td");v.style.textAlign="center";const w=document.createElement("input");w.type="text",w.value=e.position||"Java开发",w.placeholder="职位名称",w.oninput=()=>u(o,"position",w.value),v.appendChild(w),n.appendChild(v);const k=document.createElement("td");k.style.textAlign="center";const S=document.createElement("input");S.type="text",S.value=e.salary||"",S.placeholder="薪资范围",S.oninput=()=>u(o,"salary",S.value),k.appendChild(S),n.appendChild(k);const j=document.createElement("td");j.style.textAlign="center";const C=document.createElement("div");C.className="remark-tooltip";const T=document.createElement("button");T.className="remark-btn",T.innerHTML='<i class="bi bi-pencil-square"></i>',T.style.cssText="\n        display:inline-flex;align-items:center;justify-content:center;position:relative;width:28px;height:28px;margin:0 auto;padding:0;border:1px solid var(--border-color);background-color:#fff;color:var(--primary-color);font-size:14px;text-align:center;cursor:pointer;transition:all .3s ease;border-radius:4px;box-shadow:var(--shadow-sm);\n      ",e.remark&&(T.classList.add("has-content"),T.style.borderColor="var(--primary-color)",T.style.backgroundColor="var(--primary-color)",T.style.color="white"),T.onclick=()=>{!function(t){s=t;const e=document.querySelector("#jobs-record-modal #remarkModal"),o=document.querySelector("#jobs-record-modal #remarkTextarea");e&&o&&(o.value=i[t].remark||"",e.style.display="flex",o.focus())}(o)},C.appendChild(T),j.appendChild(C),n.appendChild(j);const E=document.createElement("td");E.className="action-cell",E.style.position="relative";const P=document.createElement("input");P.type="checkbox",P.checked=void 0===e.isOutsourcing||e.isOutsourcing,P.onchange=()=>u(o,"isOutsourcing",P.checked),P.style.position="absolute",P.style.top="50%",P.style.left="50%",P.style.transform="translate(-50%, -50%)",P.style.margin="0",E.appendChild(P),n.appendChild(E),t.appendChild(n)}))}}function p(){const t=document.querySelector("#jobs-record-modal #commonInfo");function e(){t.style.height="auto",t.style.height=t.scrollHeight+"px"}t&&(t.value=a,e(),t.oninput=()=>{a=t.value,e()})}function m(){const t=document.querySelector("#jobs-record-modal #summaryTextarea");if(!t)return;let e="";i.forEach((t=>{t.remark&&(e+=`【${t.name||"未命名公司"}】\n${t.remark}\n\n`)})),e||(e="暂无记录"),t.value=e.trim()}function b(t,e){const o=t+e;if(o<0||o>=i.length)return;const n=i[t];i[t]=i[o],i[o]=n,d(),c("已移动行","info")}function u(t,e,o){i[t][e]=o}function h(){i.push({name:"",size:"",position:"Java开发",salary:"",isOutsourcing:!0}),d(),setTimeout((()=>{const t=document.querySelectorAll("#jobs-record-modal #companyTable tbody tr:last-child td:nth-child(2) input");t.length>0&&t[0].focus()}),100)}function g(){GM_setValue("jobsRecordCompanyData",JSON.stringify(i)),GM_setValue("jobsRecordCommonInfoData",a),c("数据已保存","success")}function f(){const t=GM_getValue("jobsRecordCompanyData"),e=GM_getValue("jobsRecordCommonInfoData");let o=!1;if(t)try{i=JSON.parse(t),d(),m(),o=!0}catch(t){c("恢复公司数据失败","error")}if(e)try{a=e,p(),o=!0}catch(t){c("恢复常用信息数据失败","error")}o?c("数据已恢复","info"):c("没有可恢复的数据","warning")}function x(){let t="# 常用信息\n\n";t+=a+"\n\n",t+="# 公司列表\n\n",i.length>0?(t+="| 公司名称 | 信息 | 职位 | 薪资 | 外包 |\n",t+="| -------- | ---- | ---- | ---- | -------- |\n",i.forEach((e=>{const o=e.name||"未填写",n=e.size||"未填写",r=e.position||"未填写",i=e.salary||"未填写",a=e.isOutsourcing?"是":"否";t+=`| ${o} | ${n} | ${r} | ${i} | ${a} |\n`}))):t+="暂无公司信息\n",t+="\n\n# 记录汇总\n\n",t+=document.querySelector("#jobs-record-modal #summaryTextarea").value,function(t){const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.opacity=0,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e)}(t),c("已复制到剪贴板","primary")}function y(){const t=document.querySelector("#jobs-record-modal #remarkModal");t&&(t.style.display="none",s=-1)}function v(){if(-1===s)return;const t=document.querySelector("#jobs-record-modal #remarkTextarea");if(!t)return;const e=t.value.trim();i[s].remark=e;const o=document.querySelectorAll("#jobs-record-modal #companyTable tbody tr");if(o[s]){const t=o[s].querySelector(".remark-btn");t&&(e?(t.classList.add("has-content"),t.style.borderColor="var(--primary-color)",t.style.backgroundColor="var(--primary-color)",t.style.color="white"):(t.classList.remove("has-content"),t.style.borderColor="var(--border-color)",t.style.backgroundColor="#fff",t.style.color="var(--primary-color)"))}m(),y(),c("记录已保存","success")}function w(){const t=document.getElementById("jobs-record-modal");t&&document.body.removeChild(t)}d(),p(),m(),function(){const t=document.querySelector("#jobs-record-modal #closeJobsModal");t&&t.addEventListener("click",w);const e=document.querySelector("#jobs-record-modal #addCompanyBtn");e&&e.addEventListener("click",h);const o=document.querySelector("#jobs-record-modal #saveDataBtn");o&&o.addEventListener("click",g);const n=document.querySelector("#jobs-record-modal #restoreDataBtn");n&&n.addEventListener("click",f);const r=document.querySelector("#jobs-record-modal #exportDataBtn");r&&r.addEventListener("click",x);const i=document.querySelector("#jobs-record-modal #closeRemarkModalBtn"),a=document.querySelector("#jobs-record-modal #cancelRemarkBtn");i&&i.addEventListener("click",y),a&&a.addEventListener("click",y);const s=document.querySelector("#jobs-record-modal #saveRemarkBtn");s&&s.addEventListener("click",v),document.addEventListener("click",(t=>{const e=document.querySelector("#jobs-record-modal #remarkModal");e&&t.target===e&&y()})),document.addEventListener("keydown",(t=>{if("Escape"===t.key){const t=document.querySelector("#jobs-record-modal #remarkModal");t&&"flex"===t.style.display?y():w()}})),document.addEventListener("keydown",(t=>{(t.ctrlKey||t.metaKey)&&"s"===t.key&&document.getElementById("jobs-record-modal")&&(t.preventDefault(),g())}))}()}function createDraggablePanel(){const t=document.getElementById("auto-apply-panel");if(t)return{panel:t,controlBtn:t.querySelector(".control-btn"),statusDiv:t.querySelector(".status-display")};loadSavedPosition();const e=document.createElement("div");e.id="auto-apply-panel";const o=isJobsListingPage(),n=o?"full":"simple",r=(t=>{const e={top:"200px",left:window.innerWidth-300+"px"};if(!t)return e;const o=t.top&&(t.top.includes("px")||t.top.includes("%"))&&t.left&&(t.left.includes("px")||t.left.includes("%"));if(t.right&&!t.left)try{const e=t.right.match(/^([\d.]+)(.*)$/);if(e){const o=parseFloat(e[1]),n=e[2];"%"===n?t.left=100-o-10+"%":"px"===n&&(t.left=window.innerWidth-o-250+"px"),delete t.right}}catch(t){}return o?t:e})(baseConfig.panelPosition[baseConfig.currentSite][n]),i=`\n    position:fixed;top:${r.top};left:${r.left};background:rgba(255,255,255,0.2);padding:8px;border-radius:8px;box-shadow:0 4px 20px rgba(0,0,0,0.08);z-index:999999;display:flex;flex-direction:column;gap:6px;width:${o?"250px":"100px"};max-height:80vh;overflow-y:auto;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,0.1);transition:all .3s ease;cursor:default;\n  `;e.style.cssText=i;const a=document.createElement("div");a.style.cssText=`\n    display: flex;\n    gap: 8px;\n    width: 100%;\n    ${o?"":"justify-content: center;"}\n  `;const s=document.createElement("button");let l,c;if(s.className="record-btn",s.textContent="记录",s.style.cssText=`\n    padding:8px 12px;background:rgba(39,174,96,0.6);color:rgba(255,255,255,0.9);border:0;border-radius:6px;cursor:pointer;transition:all .3s ease;font-size:13px;font-weight:500;box-shadow:0 2px 8px rgba(39,174,96,0.2);flex:${o?"1":"auto"};position:relative;z-index:1000000;\n  `,s.onmouseover=()=>{s.style.transform="translateY(-1px)",s.style.background="rgba(39, 174, 96, 0.8)",s.style.boxShadow="0 4px 12px rgba(39, 174, 96, 0.3)"},s.onmouseout=()=>{s.style.transform="translateY(0)",s.style.background="rgba(39, 174, 96, 0.6)",s.style.boxShadow="0 2px 8px rgba(39, 174, 96, 0.2)"},s.onclick=()=>{showJobsRecordModal()},o&&(l=document.createElement("button"),l.className="control-btn",l.textContent="开始处理",l.style.cssText="\n      padding:8px 16px;background:rgba(67,97,238,0.6);color:rgba(255,255,255,0.9);border:0;border-radius:6px;cursor:pointer;transition:all .3s ease;font-size:13px;font-weight:500;box-shadow:0 2px 8px rgba(67,97,238,0.2);flex:3;position:relative;z-index:1000000;\n    ",utils.updateButtonState(l,!1),a.appendChild(l)),a.appendChild(s),o){c=document.createElement("div"),c.className="status-display",c.style.cssText="\n      margin-top:5px;padding:8px;background:rgba(245,245,245,0.5);border-radius:4px;font-size:12px;color:#666;transition:all .3s ease;cursor:move;min-height:20px;max-height:200px;overflow-y:auto;position:relative;user-select:none;backdrop-filter:blur(4px);border:1px solid rgba(255,255,255,0.1);\n    ";const t=document.createElement("div");t.className="default-message",t.style.cssText="\n      left:50%;transform:translate(-50%,0);padding-left:8px;background:rgba(52,152,219,0.1);border-radius:4px;font-size:12px;color:#3498db;position:relative;user-select:none;border:1px solid rgba(255,255,255,0.1);border-left:2px solid #3498db;\n      ",t.textContent=`当前页面为 ${baseConfig.currentSite}，点击开始`,c.appendChild(t)}return setupDragging(e,o?c:e),document.body.appendChild(e),o&&updateConfigDisplay(e),e.appendChild(a),o&&e.appendChild(c),{panel:e,controlBtn:l,recordBtn:s,statusDiv:c}}function setupDragging(t,e){if(!e)return;let o,n,r,i,a=!1;function s(e){a&&requestAnimationFrame((()=>{const a=e.clientX-o,s=e.clientY-n,l=r+s,c=i+a,d=t.getBoundingClientRect(),p=window.innerWidth,m=window.innerHeight,b=Math.max(0,Math.min(m-d.height,l)),u=Math.max(0,Math.min(p-d.width,c));t.style.top=`${b}px`,t.style.left=`${u}px`}))}function l(){a&&(a=!1,document.body.style.cursor="",document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",l),savePanelPosition(t))}e.addEventListener("mousedown",(function(c){const d=e.classList.contains("status-display");if(!d&&c.target===e||d&&c.target.closest(".status-display")){a=!0;const e=t.getBoundingClientRect();o=c.clientX,n=c.clientY,r=e.top,i=e.left,c.preventDefault(),document.body.style.cursor="move",document.addEventListener("mousemove",s),document.addEventListener("mouseup",l)}}))}function updateConfigDisplay(t,e=!1){const o=e?"1":"0.8",n=e?"0.2":"0.05",r=t.querySelector(".config-display");r&&r.remove();const i=`\n    <div class="config-display" style="cursor: default;"><div style="margin: 4px 0; padding: 6px; background: rgba(67, 97, 238, ${n}); border-radius: 4px; font-size: 13px; color: rgba(68, 68, 68, ${o});">        包含：<span style="color: rgba(67, 97, 238, ${o}); font-weight: 500;">${baseConfig.keywords||"无"}</span></div><div style="margin: 4px 0; padding: 6px; background: rgba(231, 76, 60, ${n}); border-radius: 4px; font-size: 13px; color: rgba(68, 68, 68, ${o});">        排除：<span style="color: rgba(231, 76, 60, ${o}); font-weight: 500;">${baseConfig.excludeKeywords||"无"}</span></div></div>\n  `;t.insertAdjacentHTML("afterbegin",i)}function updateStatus(t,e="info"){const o=document.querySelector(".status-display");if(!o)return;const n=o.querySelector(".default-message");n&&n.remove();const r=utils.createNotification(t,e).colors,i=document.createElement("div");for(i.style.cssText=`\n    margin-bottom: 4px;\n    color: ${r.text};\n    padding: 6px;\n    border-radius: 4px;\n    background: ${r.bg};\n    word-break: break-word;\n    overflow-wrap: break-word;\n    border-left: 2px solid ${r.text};\n  `,i.textContent=t,o.insertBefore(i,o.firstChild);o.children.length>20;)o.removeChild(o.lastChild);"error"===e&&(o.style.animation="shake 0.5s",setTimeout((()=>{o.style.animation=""}),500))}const styleSheet=document.createElement("style");function checkJobKeywords(t){if(!t)return!1;const e=t.textContent.toLowerCase(),o=baseConfig.keywords.toLowerCase().split(" ").filter((t=>t)),n=baseConfig.excludeKeywords.toLowerCase().split(" ").filter((t=>t));return!(o.length>0&&!o.some((t=>e.includes(t))))&&!(n.length>0&&n.some((t=>e.includes(t))))}function init(){const{controlBtn:t,recordBtn:e}=createDraggablePanel();if(isJobsListingPage()){const e=baseConfig.currentSite===SITE_TYPE.BOSS?new BossProcessor:new LaGouProcessor;t.onclick=()=>{e.isRunning?e.requestStop(t):e.start(t)}}}styleSheet.textContent="\n  @keyframes shake {\n    0%, 100% { transform: translateX(0); }\n    25% { transform: translateX(-5px); }\n    75% { transform: translateX(5px); }\n  }\n",document.head.appendChild(styleSheet),init();
}) ();
